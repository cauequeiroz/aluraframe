{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_negociacoesService","NegociacoesService","_init","listaTodos","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","event","preventDefault","cadastra","_criaNegociacao","mensagem","_limpaFormulario","apaga","esvazia","importa","coluna","_ordemAtual","inverte","ordena","a","b","Negociacao","DateHelper","textoParaData","value","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\n\n    constructor() {\n\n        let $ = document.querySelector.bind(document);\n\n        this._inputData = $('#data');\n        this._inputQuantidade = $('#quantidade');\n        this._inputValor = $('#valor');\n\n        this._listaNegociacoes = new Bind(\n            new ListaNegociacoes(),\n            new NegociacoesView($('#negociacoesView')),\n            'adiciona', 'esvazia', 'ordena', 'inverte'\n        );\n        \n        this._mensagem = new Bind(\n            new Mensagem(),\n            new MensagemView($('#mensagemView')),\n            'texto'\n        );\n\n        this._negociacoesService = new NegociacoesService();\n        this._init();\n    }\n\n    _init() {\n\n        this._negociacoesService\n            .listaTodos()\n            .then(negociacoes =>\n                negociacoes.forEach(negociacao => \n                    this._listaNegociacoes.adiciona(negociacao)))\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n    adiciona(event) {\n\n        event.preventDefault();\n\n        this._negociacoesService\n            .cadastra(this._criaNegociacao())\n            .then(mensagem => {\n                this._listaNegociacoes.adiciona(this._criaNegociacao());\n                this._mensagem.texto = mensagem;\n                this._limpaFormulario();\n            })\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n    apaga() {\n\n        this._negociacoesService\n            .apaga()\n            .then(mensagem => {\n                this._mensagem.texto = mensagem;\n                this._listaNegociacoes.esvazia();\n            })\n            .catch(erro => this._mensagem.texto = erro);            \n    }\n    \n    importaNegociacoes() {\n\n        this._negociacoesService\n            .importa(this._listaNegociacoes.negociacoes)\n            .then(negociacoes => {\n                negociacoes.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao));                \n                this._mensagem.texto = 'Negociações importadas com sucesso.';\n            })\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n\n    ordena(coluna) {\n        \n        this._ordemAtual == coluna\n            ? this._listaNegociacoes.inverte()\n            : this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n\n        this._ordemAtual = coluna;\n    }\n\n    _criaNegociacao() {\n\n        return new Negociacao(\n            DateHelper.textoParaData(this._inputData.value),\n            this._inputQuantidade.value,\n            this._inputValor.value\n        );\n    }\n\n    _limpaFormulario() {\n\n        this._inputData.value = '';\n        this._inputQuantidade.value = 1;\n        this._inputValor.value = 0;\n\n        this._inputData.focus();\n    }\n}"]}